function exportToPDF() {
  const results = Array.from(document.querySelectorAll('.result-card')).map(card => {
    const url = card.querySelector('.url').textContent;
    const status = card.querySelector('.status-tag').textContent.trim().split('\n')[1];
    const details = card.querySelector('.details').innerHTML.replace(/<br>/g, '; ');
    const timestamp = card.querySelector('.timestamp').textContent;
    return { url, status, details, timestamp };
  });

  const healthScore = document.getElementById('health-score').textContent;
  const summary = {
    total: document.getElementById('summary-total').textContent,
    ok: document.getElementById('summary-ok').textContent,
    redirects: document.getElementById('summary-redirects').textContent,
    broken: document.getElementById('summary-broken').textContent,
    risky: document.getElementById('summary-risky').textContent
  };

  const exportContent = document.createElement('div');
  exportContent.style.padding = '20px';
  exportContent.style.fontFamily = 'Poppins, sans-serif';
  exportContent.style.color = '#1a1c23';
  exportContent.innerHTML = `
    <div style="text-align: center; margin-bottom: 20px;">
      <img src="assets/logo.svg" alt="LinkCheckr Pro Logo" style="width: 48px; height: 48px;">
      <h1 style="font-size: 24px; font-weight: 700; color: #3D5AFE;">LinkCheckr Pro Scan Report</h1>
      <p style="font-size: 14px;">Generated by SIAM on ${new Date().toLocaleString()}</p>
      <p style="font-size: 14px;">Website: <a href="https://m-siam.github.io/LinkChecker-Pro/">https://m-siam.github.io/LinkChecker-Pro/</a></p>
      <p style="font-size: 12px; color: #6b7280;">Â© 2025 SIAM. All rights reserved.</p>
    </div>
    <h2 style="font-size: 18px; font-weight: 600; margin-bottom: 10px;">Summary</h2>
    <p style="font-size: 14px; margin-bottom: 20px;">
      Link Health: ${healthScore}<br>
      Total Links: ${summary.total}<br>
      OK: ${summary.ok}<br>
      Redirects: ${summary.redirects}<br>
      Broken: ${summary.broken}<br>
      Risky: ${summary.risky}
    </p>
    <h2 style="font-size: 18px; font-weight: 600; margin-bottom: 10px;">Scan Results</h2>
    <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
      <thead>
        <tr style="background: #f1f3f5;">
          <th style="padding: 8px; border: 1px solid #e0e0e0; text-align: left;">URL</th>
          <th style="padding: 8px; border: 1px solid #e0e0e0; text-align: left;">Status</th>
          <th style="padding: 8px; border: 1px solid #e0e0e0; text-align: left;">Details</th>
          <th style="padding: 8px; border: 1px solid #e0e0e0; text-align: left;">Timestamp</th>
        </tr>
      </thead>
      <tbody>
        ${results.map(result => `
          <tr>
            <td style="padding: 8px; border: 1px solid #e0e0e0;">${result.url}</td>
            <td style="padding: 8px; border: 1px solid #e0e0e0;">${result.status}</td>
            <td style="padding: 8px; border: 1px solid #e0e0e0;">${result.details || '-'}</td>
            <td style="padding: 8px; border: 1px solid #e0e0e0;">${result.timestamp}</td>
          </tr>
        `).join('')}
      </tbody>
    </table>
  `;

  const opt = {
    margin: 0.5,
    filename: 'LinkCheckr_Pro_Scan_Report.pdf',
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { scale: 2 },
    jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
  };

  html2pdf().from(exportContent).set(opt).save();
}
