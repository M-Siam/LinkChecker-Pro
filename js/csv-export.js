function exportToCSV() {
  const results = Array.from(document.querySelectorAll('.result-card')).map(card => {
    const url = card.querySelector('.url').textContent;
    const status = card.querySelector('.status-tag').textContent.trim().split('\n')[1];
    const details = card.querySelector('.details').innerHTML.replace(/<br>/g, '; ');
    const timestamp = card.querySelector('.timestamp').textContent;
    return { url, status, details, timestamp };
  });

  const healthScore = document.getElementById('health-score').textContent;
  const summary = {
    total: document.getElementById('summary-total').textContent,
    ok: document.getElementById('summary-ok').textContent,
    redirects: document.getElementById('summary-redirects').textContent,
    broken: document.getElementById('summary-broken').textContent,
    risky: document.getElementById('summary-risky').textContent
  };

  const csvContent = [
    'LinkCheckr Pro Scan Report',
    `Generated by SIAM on ${new Date().toLocaleString()}`,
    'Website: https://m-siam.github.io/LinkChecker-Pro/',
    'Â© 2025 SIAM. All rights reserved.',
    '',
    'Summary',
    `Link Health,${healthScore}`,
    `Total Links,${summary.total}`,
    `OK,${summary.ok}`,
    `Redirects,${summary.redirects}`,
    `Broken,${summary.broken}`,
    `Risky,${summary.risky}`,
    '',
    'Scan Results',
    'URL,Status,Details,Timestamp',
    ...results.map(result =>
      `"${result.url.replace(/"/g, '""')}","${result.status}","${result.details.replace(/"/g, '""') || '-'}","${result.timestamp}"`
    )
  ].join('\n');

  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);
  const link = document.createElement('a');
  link.setAttribute('href', url);
  link.setAttribute('download', 'LinkCheckr_Pro_Scan_Report.csv');
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}
